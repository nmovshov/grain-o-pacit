<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 12">
<meta name=Originator content="Microsoft Word 12">
<link rel=File-List href="opacf90help_files/filelist.xml">
<title>Code documentation: jack4.f90</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>chezy</o:Author>
  <o:LastAuthor>chezy</o:LastAuthor>
  <o:Revision>4</o:Revision>
  <o:TotalTime>10</o:TotalTime>
  <o:Created>2007-08-27T23:06:00Z</o:Created>
  <o:LastSaved>2007-08-27T23:16:00Z</o:LastSaved>
  <o:Pages>3</o:Pages>
  <o:Words>1781</o:Words>
  <o:Characters>10280</o:Characters>
  <o:Company>Tel Aviv Uiversity</o:Company>
  <o:Lines>85</o:Lines>
  <o:Paragraphs>24</o:Paragraphs>
  <o:CharactersWithSpaces>12037</o:CharactersWithSpaces>
  <o:Version>12.00</o:Version>
 </o:DocumentProperties>
</xml><![endif]-->
<link rel=themeData href="opacf90help_files/themedata.thmx">
<link rel=colorSchemeMapping href="opacf90help_files/colorschememapping.xml">
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:SpellingState>Clean</w:SpellingState>
  <w:TrackMoves/>
  <w:TrackFormatting/>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:DoNotPromoteQF/>
  <w:LidThemeOther>EN-US</w:LidThemeOther>
  <w:LidThemeAsian>X-NONE</w:LidThemeAsian>
  <w:LidThemeComplexScript>X-NONE</w:LidThemeComplexScript>
  <w:Compatibility>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:DontGrowAutofit/>
   <w:SplitPgBreakAndParaMark/>
   <w:DontVertAlignCellWithSp/>
   <w:DontBreakConstrainedForcedTables/>
   <w:DontVertAlignInTxbx/>
   <w:Word11KerningPairs/>
   <w:CachedColBalance/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
  <m:mathPr>
   <m:mathFont m:val="Cambria Math"/>
   <m:brkBin m:val="before"/>
   <m:brkBinSub m:val="--"/>
   <m:smallFrac m:val="off"/>
   <m:dispDef/>
   <m:lMargin m:val="0"/>
   <m:rMargin m:val="0"/>
   <m:defJc m:val="centerGroup"/>
   <m:wrapIndent m:val="1440"/>
   <m:intLim m:val="subSup"/>
   <m:naryLim m:val="undOvr"/>
  </m:mathPr></w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" DefUnhideWhenUsed="true"
  DefSemiHidden="true" DefQFormat="false" DefPriority="99"
  LatentStyleCount="267">
  <w:LsdException Locked="false" Priority="0" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Normal"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="heading 1"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="heading 2"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 3"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 4"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 5"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 6"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 7"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 8"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 9"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 1"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 2"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 3"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 4"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 5"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 6"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 7"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 8"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 9"/>
  <w:LsdException Locked="false" Priority="35" QFormat="true" Name="caption"/>
  <w:LsdException Locked="false" Priority="10" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Title"/>
  <w:LsdException Locked="false" Priority="1" Name="Default Paragraph Font"/>
  <w:LsdException Locked="false" Priority="11" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Subtitle"/>
  <w:LsdException Locked="false" Priority="22" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Strong"/>
  <w:LsdException Locked="false" Priority="20" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Emphasis"/>
  <w:LsdException Locked="false" Priority="59" SemiHidden="false"
   UnhideWhenUsed="false" Name="Table Grid"/>
  <w:LsdException Locked="false" UnhideWhenUsed="false" Name="Placeholder Text"/>
  <w:LsdException Locked="false" Priority="1" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="No Spacing"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 1"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 1"/>
  <w:LsdException Locked="false" UnhideWhenUsed="false" Name="Revision"/>
  <w:LsdException Locked="false" Priority="34" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="List Paragraph"/>
  <w:LsdException Locked="false" Priority="29" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Quote"/>
  <w:LsdException Locked="false" Priority="30" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Intense Quote"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 1"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 1"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 2"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 2"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 2"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 3"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 3"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 3"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 4"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 4"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 4"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 5"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 5"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 5"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 6"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 6"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 6"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="19" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Subtle Emphasis"/>
  <w:LsdException Locked="false" Priority="21" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Intense Emphasis"/>
  <w:LsdException Locked="false" Priority="31" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Subtle Reference"/>
  <w:LsdException Locked="false" Priority="32" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Intense Reference"/>
  <w:LsdException Locked="false" Priority="33" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Book Title"/>
  <w:LsdException Locked="false" Priority="37" Name="Bibliography"/>
  <w:LsdException Locked="false" Priority="39" QFormat="true" Name="TOC Heading"/>
 </w:LatentStyles>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:-1610611985 1107304683 0 0 159 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:minor-fareast;}
h1
	{mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Heading 1 Char";
	mso-margin-top-alt:auto;
	margin-right:7.2pt;
	mso-margin-bottom-alt:auto;
	margin-left:7.2pt;
	mso-pagination:widow-orphan;
	mso-outline-level:1;
	font-size:24.0pt;
	font-family:"Times New Roman","serif";
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:minor-fareast;
	color:#990000;
	font-weight:bold;}
h2
	{mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Heading 2 Char";
	mso-margin-top-alt:auto;
	margin-right:7.2pt;
	mso-margin-bottom-alt:auto;
	margin-left:7.2pt;
	mso-pagination:widow-orphan;
	mso-outline-level:2;
	font-size:18.0pt;
	font-family:"Times New Roman","serif";
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:minor-fareast;
	color:#990000;
	font-weight:bold;}
a:link, span.MsoHyperlink
	{mso-style-noshow:yes;
	mso-style-priority:99;
	color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-noshow:yes;
	mso-style-priority:99;
	color:purple;
	text-decoration:underline;
	text-underline:single;}
p
	{mso-style-priority:99;
	mso-margin-top-alt:auto;
	margin-right:7.2pt;
	mso-margin-bottom-alt:auto;
	margin-left:7.2pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:minor-fareast;}
tt
	{mso-style-noshow:yes;
	mso-style-priority:99;
	font-family:"Courier New";
	mso-ascii-font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:minor-fareast;
	mso-hansi-font-family:"Courier New";
	mso-bidi-font-family:"Courier New";}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 1";
	mso-ansi-font-size:14.0pt;
	mso-bidi-font-size:14.0pt;
	font-family:"Cambria","serif";
	mso-ascii-font-family:Cambria;
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Cambria;
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#365F91;
	mso-themecolor:accent1;
	mso-themeshade:191;
	font-weight:bold;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 2";
	mso-ansi-font-size:13.0pt;
	mso-bidi-font-size:13.0pt;
	font-family:"Cambria","serif";
	mso-ascii-font-family:Cambria;
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Cambria;
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#4F81BD;
	mso-themecolor:accent1;
	font-weight:bold;}
p.code-western, li.code-western, div.code-western
	{mso-style-name:code-western;
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-unhide:no;
	mso-margin-top-alt:auto;
	margin-right:7.2pt;
	margin-bottom:0cm;
	margin-left:7.2pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:minor-fareast;}
p.code-cjk, li.code-cjk, div.code-cjk
	{mso-style-name:code-cjk;
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-unhide:no;
	mso-margin-top-alt:auto;
	margin-right:7.2pt;
	margin-bottom:0cm;
	margin-left:7.2pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:minor-fareast;}
p.code-ctl, li.code-ctl, div.code-ctl
	{mso-style-name:code-ctl;
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-unhide:no;
	mso-margin-top-alt:auto;
	margin-right:7.2pt;
	margin-bottom:0cm;
	margin-left:7.2pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:minor-fareast;}
span.SpellE
	{mso-style-name:"";
	mso-spl-e:yes;}
.MsoChpDefault
	{mso-style-type:export-only;
	mso-default-props:yes;
	font-size:10.0pt;
	mso-ansi-font-size:10.0pt;
	mso-bidi-font-size:10.0pt;}
@page Section1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:35.4pt;
	mso-footer-margin:35.4pt;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:811409994;
	mso-list-template-ids:-1592367730;}
@list l0:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:36.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l0:level2
	{mso-level-tab-stop:72.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l0:level3
	{mso-level-tab-stop:108.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l0:level4
	{mso-level-tab-stop:144.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l0:level5
	{mso-level-tab-stop:180.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l0:level6
	{mso-level-tab-stop:216.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l0:level7
	{mso-level-tab-stop:252.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l0:level8
	{mso-level-tab-stop:288.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l0:level9
	{mso-level-tab-stop:324.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l1
	{mso-list-id:1200163292;
	mso-list-template-ids:-1186029964;}
@list l1:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:36.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l1:level2
	{mso-level-tab-stop:72.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l1:level3
	{mso-level-tab-stop:108.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l1:level4
	{mso-level-tab-stop:144.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l1:level5
	{mso-level-tab-stop:180.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l1:level6
	{mso-level-tab-stop:216.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l1:level7
	{mso-level-tab-stop:252.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l1:level8
	{mso-level-tab-stop:288.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l1:level9
	{mso-level-tab-stop:324.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-qformat:yes;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman","serif";}
</style>
<![endif]-->
<meta name=CREATED content="20060504;17394164">
<meta name=CHANGEDBY content="Naor Movshovitz">
<meta name=CHANGED content="20070828;1573217">
<meta name=date content=2006-05-04>
<meta name=m-file content=jack4.f90>
<!-- This HTML is auto-generated from an M-file.
To make changes, update the M-file and republish this document.
 --><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="1026"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body bgcolor=white lang=EN-US link=blue vlink=purple style='tab-interval:36.0pt'>

<div class=Section1>

<h1><span style='mso-fareast-font-family:"Times New Roman"'>Help for program
opac.f90<o:p></o:p></span></h1>

<p>The <tt><span style='font-size:10.0pt'>opac.f90</span></tt> program tracks
the evolution of the size distribution of dust particles in a model atmosphere,
taking into account the simultaneous processes of coagulation of particles into
larger grains, and the sedimentation of grains through the atmosphere, and
determines the opacity of the atmosphere at specified times. This program uses
a rewrite of Morris’s program <span class=SpellE><tt><span style='font-size:
10.0pt'>jack.for</span></tt></span> (with both expansions and omissions) to
perform the grain evolution calculations, and a rewrite of Morris’s <span
class=SpellE><span style='font-family:"Courier New"'>radt.for</span></span> for
the <span class=SpellE>radiative</span> transfer calculations. This document is
a user’s manual, so to speak, that I hope will help anyone who will want to
use, and very likely improve on, this program. Note that this document only
explains the code and its usage, not the physics behind it nor the algorithms
employed. </p>

<h2><i><span style='font-size:14.0pt;font-family:"Arial","sans-serif";
mso-fareast-font-family:"Times New Roman"'>Contents<o:p></o:p></span></i></h2>

<p style='margin-top:5.0pt;margin-right:7.2pt;margin-bottom:0cm;margin-left:
43.2pt;margin-bottom:.0001pt;text-indent:-18.0pt;mso-list:l0 level1 lfo2;
tab-stops:list 36.0pt'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
dir=LTR></span><a href="#1">Overview</a> </p>

<p style='margin-top:5.0pt;margin-right:7.2pt;margin-bottom:0cm;margin-left:
43.2pt;margin-bottom:.0001pt;text-indent:-18.0pt;mso-list:l0 level1 lfo2;
tab-stops:list 36.0pt'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
dir=LTR></span><a href="#2">The driver <span style='font-family:"Courier New"'>opac.f90</span></a></p>

<p style='margin-top:5.0pt;margin-right:7.2pt;margin-bottom:0cm;margin-left:
43.2pt;margin-bottom:.0001pt;text-indent:-18.0pt;mso-list:l0 level1 lfo2;
tab-stops:list 36.0pt'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
dir=LTR></span>The <span class=SpellE><span style='font-family:"Courier New"'>globals</span></span>
module</p>

<h2><a name=1></a><i><span style='font-size:14.0pt;font-family:"Arial","sans-serif";
mso-fareast-font-family:"Times New Roman"'>Overview<o:p></o:p></span></i></h2>

<p>This program comes in four source files. They are: <span style='font-family:
"Courier New"'>opac.f90</span>, <span style='font-family:"Courier New"'>globals.f90</span>,
<span style='font-family:"Courier New"'>jack.f90</span>, and <span
style='font-family:"Courier New"'>radt.f90</span>. The file <span
style='font-family:"Courier New"'>opac.f90</span> contains the ‘driver’, or
‘main’ of the program, in computer programmers terms. In people terms this is
where the execution starts and moves down line after line, calling the
functions and subroutines that are written in other files. If you are satisfied
with my algorithms and implementation of physical processes then this is the
only file you will need to view and edit. (If you are also satisfied with my
choices for file names and output formats then you don’t even need to go to
these lengths. See the section on the configuration file.) However, if you need
to change, correct, or extend, then you will need to be familiar with the other
source files as well.</p>

<p>The file <span style='font-family:"Courier New"'>globals.f90</span> contains
the <span class=SpellE><span style='font-family:"Courier New"'>globals</span></span>
module. This module has several purposes. The first is to define the collection
of <i>global</i> variables. Global variables are variables that are visible and
recognized throughout the program. They don’t need to be passed back and forth
between subroutines and functions. (In Fortran 77 one would define these
variables in a <span style='font-family:"Courier New"'>common</span> block in
every routine that needs to use them, and this would accomplish the mission.
But in Fortran 90 there is a nicer way: define these variables <i>once</i>, in
a module, then <span style='font-family:"Courier New"'>USE</span> that module
in any other part of the program that needs to see these variables.) There are
many global variables in the program even though I am aware that this is
considered bad practice. Variables starting with <span class=SpellE><span
style='font-family:"Courier New"'>atm</span></span><span style='font-family:
"Courier New"'>_</span> all contain information about the model atmosphere. Variables
starting with <span style='font-family:"Courier New"'>dust_</span> are those
containing the information on the aerosol grains in the atmosphere. Variables
starting with <span class=SpellE><span style='font-family:"Courier New"'>params</span></span><span
style='font-family:"Courier New"'>_</span> hold the program’s free parameters.
All of these variables are read from a configuration file. Variables starting
with <span class=SpellE><span style='font-family:"Courier New"'>cfg</span></span><span
style='font-family:"Courier New"'>_</span> contain things like file names and
flags. These are also read from the configuration file. Finally, variables
starting with <span style='font-family:"Courier New"'>debug_</span> are those
that are not really needed to run the program but are useful for checking and
debugging.</p>

<p>Besides the definitions of global variables, the <span style='font-family:
"Courier New"'>global</span> module contains three routines. The <span
class=SpellE><span style='font-family:"Courier New"'>oSetup</span></span>
subroutine is responsible for reading everything that the program needs from
outside input files (see the section on input files) and performing all the
one-time calculations that are necessary before the evolution code can run. If
you ever need to use more parameters or inputs in the program I recommend you
code them into this subroutine. The <span class=SpellE><span style='font-family:
"Courier New"'>interp</span></span> function does linear interpolation on data
tables because this is needed a couple of times in the program. The subroutine <span
class=SpellE><span style='font-family:"Courier New"'>debugMass</span></span>
computes the total mass of solids in each layer of the atmosphere. The result
is placed in the (global) vector <span class=SpellE><span style='font-family:
"Courier New"'>debug_massInAtm</span></span>.</p>

<p>The file <span style='font-family:"Courier New"'>jack.f90</span> contains
the <span style='font-family:"Courier New"'>jack</span> module. This is the
module that is responsible for the grain evolution calculations. It contains
one subroutine, <span style='font-family:"Courier New"'>jack4</span>, that
accepts two arguments: <span class=SpellE><span style='font-family:"Courier New"'>sTime</span></span>
and <span class=SpellE><span style='font-family:"Courier New"'>eTime</span></span>.
A <span style='font-family:"Courier New"'>call jack4(<span class=SpellE>sTime,eTime</span>)</span>
statement in the main program will run the grain evolution code for <span
class=SpellE><span style='font-family:"Courier New"'>eTime-sTime</span></span>
seconds and the resulting distribution of grain sizes will be saved in the
array <span class=SpellE><span style='font-family:"Courier New"'>dust_nDensity</span></span>.
Note that this subroutine is the main consumer of computation time in this
program, and may take between a few minutes to many minutes to run. This
subroutine also produces progress messages on the screen and these can be
disabled by the configuration file.</p>

<p>The file <span style='font-family:"Courier New"'>radt.f90</span> contains
the <span class=SpellE><span style='font-family:"Courier New"'>radt</span></span>
module. This module is responsible for the <span class=SpellE>radiative</span>
transfer calculations. It contains one subroutine, <span style='font-family:
"Courier New"'>radt1</span>, and two ‘helper’ functions, <span class=SpellE><span
style='font-family:"Courier New"'>mie</span></span> and <span class=SpellE><span
style='font-family:"Courier New"'>dBdT</span></span>. A call to <span
class=SpellE><span style='font-family:"Courier New"'>radt</span></span> from
the main program (no arguments) calculates the dust’s contribution to the
opacity of each layer of the atmosphere, in centimeters squared per gram, and
saves the values in the array <span class=SpellE><span style='font-family:"Courier New"'>atm_opacity</span></span>.
This subroutine is very fast to execute. The subroutine itself calls the helper
functions.</p>

<p>Apart from the source files described above, the program uses up to five
input files. These are:</p>

<p style='margin-left:43.2pt;text-indent:-18.0pt;mso-list:l1 level1 lfo4;
tab-stops:list 36.0pt'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
dir=LTR></span><span style='font-family:"Courier New"'>cfg.dat</span> – The
configuration file. Specifies model parameters, file names, control options,
etc.</p>

<p style='margin-left:43.2pt;text-indent:-18.0pt;mso-list:l1 level1 lfo4;
tab-stops:list 36.0pt'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
dir=LTR></span><span style='font-family:"Courier New"'>atm.dat</span> – The
atmosphere file. With columns for height density and temperature, in <span
class=SpellE>cgs</span> units.</p>

<p style='margin-left:43.2pt;text-indent:-18.0pt;mso-list:l1 level1 lfo4;
tab-stops:list 36.0pt'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
dir=LTR></span><span style='font-family:"Courier New"'>ind.dat</span> – A table
of wavelength-dependent refractive indices.</p>

<p style='margin-left:43.2pt;text-indent:-18.0pt;mso-list:l1 level1 lfo4;
tab-stops:list 36.0pt'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
dir=LTR></span><span style='font-family:"Courier New"'>tes.dat</span> – Source
file. Input of solids into the atmosphere from <span class=SpellE>planetesimal</span>
breakup. Optional.</p>

<p style='margin-left:43.2pt;text-indent:-18.0pt;mso-list:l1 level1 lfo4;
tab-stops:list 36.0pt'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
dir=LTR></span><span style='font-family:"Courier New"'>dst.dat</span> – Initial
distribution file of grains of all sizes in each layer. Optional. Used to
continue an interrupted run.</p>

<p>The section on the configuration file explains how this file can be used to
set program parameters, and expanded to introduce new parameters.</p>

<p>The rest of this document is divided into sections describing each of the
program’s files in detail. It is NOT necessary to read this whole document
before using the program. The sections on opac.f90 and cfg.dat are recommended
if you want to quickly set and run some scenarios.</p>

<h2><a name=2></a><i><span style='font-size:14.0pt;font-family:"Arial","sans-serif";
mso-fareast-font-family:"Times New Roman"'>The driver </span></i><i><span
style='font-size:14.0pt;font-family:"Courier New";mso-fareast-font-family:"Times New Roman"'>opac.f90</span></i><i><span
style='font-size:14.0pt;font-family:"Arial","sans-serif";mso-fareast-font-family:
"Times New Roman"'><o:p></o:p></span></i></h2>

<p>The “main” of the program is in the file <span style='font-family:"Courier New"'>opac.f90</span>.
I tries to write it as a “template”, so that a few changes in obvious places is
all that is needed to run a new scenario. The program starts with</p>

<p style='margin-top:0cm;margin-right:7.1pt;margin-bottom:0cm;margin-left:7.1pt;
margin-bottom:.0001pt;background:#E6E6E6'><span style='font-family:"Courier New"'>program
<span class=SpellE>opac</span></span></p>

<p style='margin-top:0cm;margin-right:7.1pt;margin-bottom:0cm;margin-left:7.1pt;
margin-bottom:.0001pt;background:#E6E6E6'><span style='font-family:"Courier New"'>use
<span class=SpellE>globals</span></span></p>

<p style='margin-top:0cm;margin-right:7.1pt;margin-bottom:0cm;margin-left:7.1pt;
margin-bottom:.0001pt;background:#E6E6E6'><span style='font-family:"Courier New"'>use
jack</span></p>

<p style='margin-top:0cm;margin-right:7.1pt;margin-bottom:0cm;margin-left:7.1pt;
margin-bottom:.0001pt;background:#E6E6E6'><span style='font-family:"Courier New"'>use
<span class=SpellE>radt</span></span></p>

<p style='margin-top:14.4pt;margin-right:7.2pt;margin-bottom:14.4pt;margin-left:
7.2pt'>If you ever add a new module, this is the (only!) place to declare it.
The order matters, i.e., if the new module depends on the old ones it should be
<span style='font-family:"Courier New"'>use</span>d after them, and vice versa.</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>implicit none</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>character(<span
class=SpellE>len</span>=20) :: <span class=SpellE>configFile</span>='' </p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>character(<span
class=SpellE>len</span>=50) :: out1='',out2=''</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>character(<span
class=SpellE>len</span>=10) :: <span class=SpellE>dateTime</span>='',<span
class=SpellE>dateDate</span>=''</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>integer :: <span
class=SpellE>j,k,N</span></p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>real(8) ::
ct1,ct2,m1,m2,from,until</p>

<p style='margin-top:14.4pt;margin-right:7.2pt;margin-bottom:14.4pt;margin-left:
7.2pt'>The program’s local variable. If you add more local variables, keep in
mind that there is already a large number of variable in scope, namely, all the
public variables in the <span style='font-family:"Courier New"'>use</span>d
module. I tried to give them long names in order to avoid accidents. If you
want to make sure the a variable name is not already used search the module
files.</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'><span
class=SpellE>configFile</span>='cfg.dat'</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>call <span
class=SpellE>oSetup</span>(<span class=SpellE>configFile</span>)</p>

<p style='margin-top:14.4pt;margin-right:7.2pt;margin-bottom:14.4pt;margin-left:
7.2pt'>Set the name of configuration file and run the setup routine. The data
is read from input files, parameters are set, and one-time calculations are
performed.</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>do j=2,10</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>if(<span
class=SpellE>tTimes</span>(j)==0) exit</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>end do</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>N=j-2</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>do j=1,N</p>

<p style='margin-top:14.4pt;margin-right:7.2pt;margin-bottom:14.4pt;margin-left:
7.2pt'>These lines check how many target times were entered in the
configuration file. Up to ten target times can be entered and the program saves
output files at these times. Don’t change these lines. To change the number of
target times use the configuration file. The rest of the program now runs <span
style='font-family:"Courier New"'>N</span> times.</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;mso-margin-bottom-alt:
auto;margin-left:7.1pt;background:#E6E6E6'>call <span class=SpellE>date_and_time</span>(<span
class=SpellE>dateDate,dateTime</span>)</p>

<p style='margin-top:14.4pt;margin-right:7.2pt;margin-bottom:14.4pt;margin-left:
7.2pt'>To avoid writing over old files, all the output files are given unique
names that contain the date and time. <span class=SpellE><span
style='font-family:"Courier New"'>date_and_time</span></span> is a FORTRAN
subroutine.</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>call <span
class=SpellE>debugMass</span>()</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>m1=sum(<span
class=SpellE>debug_massInAtm</span>)+<span class=SpellE>debug_massInCore</span></p>

<p style='margin-top:14.4pt;margin-right:7.2pt;margin-bottom:14.4pt;margin-left:
7.2pt'>This is an optional call to a subroutine that finds the total mass of
grains in the atmosphere. Use this to check on mass conservation.</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>from=<span
class=SpellE>tTimes</span>(j); until=<span class=SpellE>tTimes</span>(j+1) !
(seconds)</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>call jack4(<span
class=SpellE>from,until</span>)</p>

<p style='margin-top:14.4pt;margin-right:7.2pt;margin-bottom:14.4pt;margin-left:
7.2pt'>This is the call to the grain size distribution calculation, and the
program will spend a few minutes here. During this time progress messages will
be printed on the screen. To disable progress messages use the configuration
file. To edit what is in the progress messages, or to change the frequency of
messages, you’ll have to edit the function <span style='font-family:"Courier New"'>jack4</span>.
The array <span class=SpellE><span style='font-family:"Courier New"'>dust_nDensity</span></span>
now holds the size distribution.</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>call <span
class=SpellE>debugMass</span>()</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>m2=sum(<span
class=SpellE>debug_massInAtm</span>)+<span class=SpellE>debug_massInCore</span></p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(*,*)'Total
start mass was ',m1,' g.'</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(*,*)'Total
end mass is ',m2,' g.'</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(*,*)'Total
mass difference is ',m2-m1,' g.'</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>k=0; if (<span
class=SpellE>cfg_srcFlg</span>) k=1</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(*,*)'Total
mass input was ',&amp;</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>sum(<span
class=SpellE>dust_source</span>*<span class=SpellE>atm_dV</span>)*(until-from)*<span
class=SpellE>dble</span>(k),' g.'</p>

<p style='margin-top:14.4pt;margin-right:7.2pt;margin-bottom:14.4pt;margin-left:
7.2pt'>This is how you check for mass conservation. The total mass after <span
style='font-family:"Courier New"'>jack4</span> was run should be equal to the
mass before the run, plus the input mass. A significant difference between mass
difference and mass input may indicate a problem.</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>call radt1()</p>

<p style='margin-top:14.4pt;margin-right:7.2pt;margin-bottom:14.4pt;margin-left:
7.2pt'>The <span style='font-family:"Courier New"'>radt1</span> subroutine only
takes a few seconds. Then arrays <span class=SpellE><span style='font-family:
"Courier New"'>atm_opacity</span></span> and <span class=SpellE><span
style='font-family:"Courier New"'>atm_opticalDepth</span></span> then hold the
opacity and optical depth of the atmosphere layers.</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>out1='<span
class=SpellE>opacOutDist</span>'//trim(<span class=SpellE>dateDate</span>)//trim(<span
class=SpellE>dateTime</span>(1:6))//'.<span class=SpellE>dat</span>'</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>out2='<span
class=SpellE>opacOutOptic</span>'//trim(<span class=SpellE>dateDate</span>)//trim(<span
class=SpellE>dateTime</span>(1:6))//'.<span class=SpellE>dat</span>'</p>

<p style='margin-top:14.4pt;margin-right:7.2pt;margin-bottom:14.4pt;margin-left:
7.2pt'>I use two output files, one to hold the size distribution and one for
the opacity vs. height profile. The file names are generated with a unique date
and time stamp. You can edit these lines to change the output file names, and
the next few lines to change their content.</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>open(11,file=out1,action='write')</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)'---
BEGIN HEADER ---'</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)'This
is output from ''opac.f90'' run on '//&amp;</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'><span
class=SpellE>dateDate</span>(7:8)//'/'//<span class=SpellE>dateDate</span>(5:6)//'/'//<span
class=SpellE>dateDate</span>(1:4)//&amp;</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>', at '//<span
class=SpellE>dateTime</span>(1:2)//':'//<span class=SpellE>dateTime</span>(3:4)//':'//&amp;</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'><span
class=SpellE>dateTime</span>(5:6)//'.'</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)'Evolution
time: ',(from),'--',(until),' seconds.'</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)'Atmosphere:
',trim(<span class=SpellE>cfg_atmFile</span>)</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)'Used
parameters:'</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)'<span
class=SpellE>monomerSize</span> = ',<span class=SpellE>params_monomerSize</span></p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)'<span
class=SpellE>nBins</span> = ',<span class=SpellE>params_nBins</span></p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)'spacing
parameter = ',<span class=SpellE>params_binSpacingParameter</span></p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)'sticking
coefficient = ',<span class=SpellE>params_stickCoef</span></p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)'dust-to-gas
ratio = ',params_dust2gasRatio</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)'<span
class=SpellE>srcSize</span> = ',<span class=SpellE>cfg_srcSize</span></p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)'<span
class=SpellE>coag</span> =',<span class=SpellE>cfg_cogFlg</span>,' <span
class=SpellE>sed</span> =',<span class=SpellE>cfg_flxFlg</span>,' <span
class=SpellE>src</span> =',<span class=SpellE>cfg_srcFlg</span></p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)'In
this file, the number in the (<span class=SpellE>j,k</span>) place is the
'//&amp;</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>'number density
of k-<span class=SpellE>th</span> bin grains in the j-<span class=SpellE>th</span>
layer, '//&amp;</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>'in cm^-3.'</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)'---
END HEADER ---'</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)'---
BEGIN DATA ---' ! it helps to have this line when we</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>! read from the
file to some program.</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>do k=1,atm_nZones</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)<span
class=SpellE>dust_nDensity</span>(k,1:params_nBins)</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>end do</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>close(11)</p>

<p style='margin-top:14.4pt;margin-right:7.2pt;margin-bottom:14.4pt;margin-left:
7.2pt'>This is the size distribution output, with a header that identifies the
run scenario. You can edit these lines to include more or less information in
the header. I recommend keeping this format of header and data, separated with
an easily identifiable line.</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>open(11,file=out2,action='write')</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)'---
BEGIN HEADER ---'</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)'This
is output from ''opac.f90'' run on '//&amp;</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'><span
class=SpellE>dateDate</span>(7:8)//'/'//<span class=SpellE>dateDate</span>(5:6)//'/'//<span
class=SpellE>dateDate</span>(1:4)//&amp;</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>', at '//<span
class=SpellE>dateTime</span>(1:2)//':'//<span class=SpellE>dateTime</span>(3:4)//':'//&amp;</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'><span
class=SpellE>dateTime</span>(5:6)//'.'</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)'Evolution
time: ',(from),'--',(until),' seconds.'</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)'Atmosphere:
',trim(<span class=SpellE>cfg_atmFile</span>)</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)'Used
parameters:'</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)'<span
class=SpellE>monomerSize</span> = ',<span class=SpellE>params_monomerSize</span></p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)'<span
class=SpellE>nBins</span> = ',<span class=SpellE>params_nBins</span></p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)'spacing
parameter = ',<span class=SpellE>params_binSpacingParameter</span></p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)'sticking
coefficient = ',<span class=SpellE>params_stickCoef</span></p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)'dust-to-gas
ratio = ',params_dust2gasRatio</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)'<span
class=SpellE>srcSize</span> = ',<span class=SpellE>cfg_srcSize</span></p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)'<span
class=SpellE>coag</span> =',<span class=SpellE>cfg_cogFlg</span>,' <span
class=SpellE>sed</span> =',<span class=SpellE>cfg_flxFlg</span>,' <span
class=SpellE>src</span> =',<span class=SpellE>cfg_srcFlg</span></p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)'Columns
in this file:'</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)'[height
(cm)] [opacity (cm^2/g)] [optical depth]'</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)'---
END HEADER ---'</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)'---
BEGIN DATA ---' ! it helps to have this line when we</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>! read from the
file to some program.</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>do
k=1,atm_nZones</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>write(11,*)<span
class=SpellE>atm_Z</span>(k),<span class=SpellE>atm_opacity</span>(k),<span
class=SpellE>atm_opticalDepth</span>(k)</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>end do</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>close(11)</p>

<p style='margin-top:14.4pt;margin-right:7.2pt;margin-bottom:14.4pt;margin-left:
7.2pt'>This is the second output file, with opacity vs. height. The header is
the same.</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>end do</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>stop</p>

<p class=code-western style='margin-top:0cm;margin-right:7.1pt;margin-bottom:
0cm;margin-left:7.1pt;margin-bottom:.0001pt;background:#E6E6E6'>end program <span
class=SpellE>opac</span></p>

<p style='margin-top:14.4pt;margin-right:7.2pt;margin-bottom:14.4pt;margin-left:
7.2pt'>The <span style='font-family:"Courier New"'>do</span> loop runs for all
target times, then the program ends.</p>

<h2><i><span style='font-size:14.0pt;font-family:"Arial","sans-serif";
mso-fareast-font-family:"Times New Roman"'>The module </span></i><i><span
style='font-size:14.0pt;font-family:"Courier New";mso-fareast-font-family:"Times New Roman"'>globals.f90<o:p></o:p></span></i></h2>

<p style='margin-top:14.4pt;margin-right:7.2pt;margin-bottom:14.4pt;margin-left:
7.2pt'>Bla</p>

</div>

</body>

</html>
